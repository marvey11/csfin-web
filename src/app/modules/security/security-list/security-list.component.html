<div class="container">
  <div class="card">
    <h1 class="card-header">List of Securities</h1>
    <div class="card-body">
      <table class="table table-striped table-hover">
        <ng-template [ngIf]="groupingEnabled" [ngIfElse]="ungroupedTable">
          <thead>
            <tr>
              <th scope="col">ISIN</th>
              <th scope="col">NSIN</th>
              <th scope="col">Name</th>
            </tr>
          </thead>
          <ng-template ngFor let-group [ngForOf]="groupedSecurities | keyvalue">
            <tbody>
              <tr class="group-header">
                <th scope="row" colspan="4">{{ groupLabels.get(group.key) || "Unkown" }}</th>
              </tr>
              <tr *ngFor="let s of getSorted(group.value)">
                <td>{{ s.isin }}</td>
                <td>{{ s.nsin }}</td>
                <td>{{ s.name }}</td>
              </tr>
            </tbody>
          </ng-template>
        </ng-template>
        <ng-template #ungroupedTable>
          <thead>
            <tr>
              <th scope="col">ISIN</th>
              <th scope="col">NSIN</th>
              <th scope="col">Name</th>
              <th scope="col">Type</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let s of getSorted(securities)">
              <td>{{ s.isin }}</td>
              <td>{{ s.nsin }}</td>
              <td>{{ s.name }}</td>
              <td>{{ typeLabels.get(s.type) || "Unknown" }}</td>
            </tr>
          </tbody>
        </ng-template>
      </table>

      <button class="btn btn-danger" (click)="toggleGrouping()">
        <span *ngIf="groupingEnabled; else showUngrouped">Show Ungrouped</span>
        <ng-template #showUngrouped><span>Group by Type</span></ng-template>
      </button>
    </div>
  </div>
</div>
